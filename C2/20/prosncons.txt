Код стал короче(изначальный можно посмотреть по изменениям в репо).
Чтобы сделать из отрицательного числа положительное просто ставим перед -a[i] вместо умножения.